<!DOCTYPE html>
<html>
<head>
  <title>Profile.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../";
    var thisFile = "Users/barton/projects/snowflakework/snowflake/containers/Profile.js";
    var defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#profile.js">Profile.js</a>
      </div>

      <div class="heading h2">
        <a href="#imports">Imports</a>
      </div>

      <div class="heading h2">
        <a href="#styles">Styles</a>
      </div>

      <div class="heading h2">
        <a href="#redux-boilerplate">Redux boilerplate</a>
      </div>

      <div class="heading h3">
        <a href="#translations">Translations</a>
      </div>

      <div class="heading h2">
        <a href="#profile-class">Profile class</a>
      </div>

      <div class="heading h3">
        <a href="#onchange">onChange</a>
      </div>

      <div class="heading h3">
        <a href="#componentwillreceiveprops">componentWillReceiveProps</a>
      </div>

      <div class="heading h3">
        <a href="#componentdidmount">componentDidMount</a>
      </div>

      <div class="heading h3">
        <a href="#render">render</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="profile.js">
  <h1>
    <a href="#profile.js" name="profile.js" class="pilcrow"></a>
Profile.js
  </h1>
</div>
</div>
<div class="body">
<p>This component provides an interface for a logged in user to change
their username and email.
It too is a container so there is boilerplate from Redux similar to
<code>App</code> and <code>Login</code></p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="imports">
  <h2>
    <a href="#imports" name="imports" class="pilcrow"></a>
Imports
  </h2>
</div>
</div>
<div class="body">
<p>Redux</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> { bindActionCreators } <span class="hljs-keyword">from</span> <span class="hljs-string">'redux'</span>;
<span class="hljs-keyword">import</span> { connect } <span class="hljs-keyword">from</span> <span class="hljs-string">'react-redux'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<div class="dox">
<div class="summary">
<p>The actions we need</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> profileActions <span class="hljs-keyword">from</span> <span class="hljs-string">'../reducers/profile/profileActions'</span>;
<span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> globalActions <span class="hljs-keyword">from</span> <span class="hljs-string">'../reducers/global/globalActions'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<div class="dox">
<div class="summary">
<p>Immutable Mapn</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> {<span class="hljs-built_in">Map</span>} <span class="hljs-keyword">from</span> <span class="hljs-string">'immutable'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<div class="dox">
<div class="summary">
<p>The ErrorAlert will display any and all errors</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> ErrorAlert <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/ErrorAlert'</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<div class="dox">
<div class="summary">
<p>The FormButton will respond to the press</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> FormButton <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/FormButton'</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<div class="dox">
<div class="summary">
<p>The Header will display a Image and support Hot Loading</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> Header <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/Header'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<div class="dox">
<div class="summary">
<p>The itemCheckbox will display the state of the email verified</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> ItemCheckbox <span class="hljs-keyword">from</span> <span class="hljs-string">'../components/ItemCheckbox'</span>;
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<div class="dox">
<div class="summary">
<p>The necessary React components</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> React, {Component} <span class="hljs-keyword">from</span> <span class="hljs-string">'react'</span>;
<span class="hljs-keyword">import</span>
{
  StyleSheet,
  View
}
<span class="hljs-keyword">from</span> <span class="hljs-string">'react-native'</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<div class="dox">
<div class="summary">
<p>The form processing component</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">import</span> t <span class="hljs-keyword">from</span> <span class="hljs-string">'tcomb-form-native'</span>;

<span class="hljs-keyword">let</span> Form = t.form.Form;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="styles">
  <h2>
    <a href="#styles" name="styles" class="pilcrow"></a>
Styles
  </h2>
</div>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> styles = StyleSheet.create({
  container: {
    flexDirection: <span class="hljs-string">'column'</span>,
    flex: <span class="hljs-number">1</span>,
    backgroundColor: <span class="hljs-string">'transparent'</span>
  },
  inputs: {
    marginTop: <span class="hljs-number">10</span>,
    marginBottom: <span class="hljs-number">10</span>,
    marginLeft: <span class="hljs-number">10</span>,
    marginRight: <span class="hljs-number">10</span>
  }
});

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="redux-boilerplate">
  <h2>
    <a href="#redux-boilerplate" name="redux-boilerplate" class="pilcrow"></a>
Redux boilerplate
  </h2>
</div>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapStateToProps</span>(<span class="hljs-params">state</span>) </span>{
    <span class="hljs-keyword">return</span> {
        profile: state.profile,
        global: {
            currentUser: state.global.currentUser,
            currentState: state.global.currentState,
            showState: state.global.showState,
        },
    };
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">mapDispatchToProps</span>(<span class="hljs-params">dispatch</span>) </span>{
  <span class="hljs-keyword">return</span> {
    actions: bindActionCreators({ ...profileActions, ...globalActions }, dispatch),
  };
}
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="translations">
  <h3>
    <a href="#translations" name="translations" class="pilcrow"></a>
Translations
  </h3>
</div>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> I18n = <span class="hljs-built_in">require</span>(<span class="hljs-string">'react-native-i18n'</span>);
<span class="hljs-keyword">import</span> Translations <span class="hljs-keyword">from</span> <span class="hljs-string">'../lib/Translations'</span>;
I18n.translations = Translations;


<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Profile</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Component</span> </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="profile-class">
  <h2>
    <a href="#profile-class" name="profile-class" class="pilcrow"></a>
Profile class
  </h2>
</div>
<p>Set the initial state and prepare the errorAlert</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">constructor</span>(props) {
    <span class="hljs-keyword">super</span>(props);
    <span class="hljs-keyword">this</span>.errorAlert = <span class="hljs-keyword">new</span> ErrorAlert();
    <span class="hljs-keyword">this</span>.state = {
      formValues: {
        username: <span class="hljs-string">''</span>,
        email: <span class="hljs-string">''</span>
      }
    };
  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="onchange">
  <h3>
    <a href="#onchange" name="onchange" class="pilcrow"></a>
onChange
  </h3>
</div>
</div>
<div class="body">
<p>When any fields change in the form, fire this action so they can
be validated.</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  onChange(value) {
    <span class="hljs-keyword">if</span> (value.username != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.props.actions.onProfileFormFieldChange(<span class="hljs-string">'username'</span>,value.username);
    }
    <span class="hljs-keyword">if</span> (value.email != <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.props.actions.onProfileFormFieldChange(<span class="hljs-string">'email'</span>,value.email);
    }
    <span class="hljs-keyword">this</span>.setState({value});
  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="componentwillreceiveprops">
  <h3>
    <a href="#componentwillreceiveprops" name="componentwillreceiveprops" class="pilcrow"></a>
componentWillReceiveProps
  </h3>
</div>
</div>
<div class="body">
<p>Since the Forms are looking at the state for the values of the
fields, when we we need to set them</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  componentWillReceiveProps(props) {
    <span class="hljs-keyword">this</span>.setState({
      formValues: {
        username: props.profile.form.fields.username,
        email: props.profile.form.fields.email
      }
    });

  }
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="componentdidmount">
  <h3>
    <a href="#componentdidmount" name="componentdidmount" class="pilcrow"></a>
componentDidMount
  </h3>
</div>
</div>
<div class="body">
<p>During Hot Loading, when the component mounts due the state
immediately being in a &quot;logged in&quot; state, we need to just set the
form fields.  Otherwise, we need to go fetch the fields</p>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  componentDidMount() {
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>.props.profile.form.fields.username == <span class="hljs-string">''</span> &amp;&amp; <span class="hljs-keyword">this</span>.props.profile.form.fields.email == <span class="hljs-string">''</span>) {
      <span class="hljs-keyword">this</span>.props.actions.getProfile(<span class="hljs-keyword">this</span>.props.global.currentUser);
    } <span class="hljs-keyword">else</span> {
      <span class="hljs-keyword">this</span>.setState({
        formValues: {
          username: <span class="hljs-keyword">this</span>.props.profile.form.fields.username,
          email: <span class="hljs-keyword">this</span>.props.profile.form.fields.email
        }
      });
    }
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="dox">
<div class="summary">
<div class="pilwrap" id="render">
  <h3>
    <a href="#render" name="render" class="pilcrow"></a>
render
  </h3>
</div>
<p>display the form wrapped with the header and button</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">  render() {
    <span class="hljs-keyword">this</span>.errorAlert.checkError(<span class="hljs-keyword">this</span>.props.profile.form.error);

    <span class="hljs-keyword">let</span> self = <span class="hljs-keyword">this</span>;

    <span class="hljs-keyword">let</span> ProfileForm = t.struct({
      username: t.String,
      email: t.String
    });
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19"></a>
</div>
<div class="dox">
<div class="summary">
<p>Set up the field definitions.  If we're fetching, the fields
are disabled.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">let</span> options = {
      auto: <span class="hljs-string">'placeholders'</span>,
      fields: {
        username: {
          label: I18n.t(<span class="hljs-string">"Profile.username"</span>),
          maxLength: <span class="hljs-number">12</span>,
          editable: !<span class="hljs-keyword">this</span>.props.profile.form.isFetching,
          hasError: <span class="hljs-keyword">this</span>.props.profile.form.fields.usernameHasError,
          error: <span class="hljs-keyword">this</span>.props.profile.form.fields.usernameErrorMsg
        },
        email: {
          label: I18n.t(<span class="hljs-string">"Profile.email"</span>),
          keyboardType: <span class="hljs-string">'email-address'</span>,
          editable: !<span class="hljs-keyword">this</span>.props.profile.form.isFetching,
          hasError: <span class="hljs-keyword">this</span>.props.profile.form.fields.emailHasError,
          error: <span class="hljs-keyword">this</span>.props.profile.form.fields.emailErrorMsg
        }
      }
    };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20"></a>
</div>
<div class="dox">
<div class="summary">
<p>When the button is pressed, send the users info including the
<code>currrentUser</code> object as it contains the sessionToken and
user objectId which Parse.com requires</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">let</span> profileButtonText = I18n.t(<span class="hljs-string">"Profile.update"</span>);
    <span class="hljs-keyword">let</span> onButtonPress = () =&gt; {
      <span class="hljs-keyword">this</span>.props.actions.updateProfile(
        <span class="hljs-keyword">this</span>.props.profile.form.originalProfile.objectId,
        <span class="hljs-keyword">this</span>.props.profile.form.fields.username,
        <span class="hljs-keyword">this</span>.props.profile.form.fields.email,
        <span class="hljs-keyword">this</span>.props.global.currentUser);
    };
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21"></a>
</div>
<div class="dox">
<div class="summary">
<p>Wrap the form with the header and button.  The header props are
mostly for support of Hot reloading. See the docs for Header
for more info.</p>
</div>
<div class="body">
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">let</span> verfiedText = I18n.t(<span class="hljs-string">"Profile.verified"</span>) +
                       <span class="hljs-string">' ('</span> +
                       I18n.t(<span class="hljs-string">"Profile.display"</span>) +
                       <span class="hljs-string">')'</span>;
    <span class="hljs-keyword">return</span> (
      &lt;View style={styles.container}&gt;
        &lt;Header isFetching={this.props.profile.form.isFetching}
                showState={this.props.global.showState}
                currentState={this.props.global.currentState}
                onGetState={this.props.actions.getState}
                onSetState={this.props.actions.setState}
        /&gt;
        &lt;View style={styles.inputs}&gt;
          &lt;Form
              ref="form"
              type={ProfileForm}
              options={options}
              value={this.state.formValues}
              onChange={this.onChange.bind(self)}
          /&gt;
        &lt;ItemCheckbox text={verfiedText}
                        disabled={true}
                        checked={this.props.profile.form.fields.emailVerified}
          /&gt;
        &lt;/View&gt;

        &lt;FormButton
            isDisabled={!this.props.profile.form.isValid || this.props.profile.form.isFetching}
            onPress={onButtonPress.bind(self)}
            buttonText={profileButtonText}/&gt;


      &lt;/View&gt;
    );
  }
}
export default connect(mapStateToProps, mapDispatchToProps)(Profile);

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
